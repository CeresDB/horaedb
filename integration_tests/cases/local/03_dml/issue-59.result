DROP TABLE IF EXISTS issue59;

affected_rows: 0

CREATE TABLE issue59 (
    ts timestamp NOT NULL,
    id int,
    account string,
    timestamp KEY (ts)) ENGINE=Analytic
WITH(
	 enable_ttl='false'
);

affected_rows: 0

SELECT id+1, count(distinct(account))
FROM issue59
GROUP BY id+1;

affected_rows: -1

explain SELECT id+1, count(distinct(account))
FROM issue59
GROUP BY id+1;

plan_type,plan,
String("logical_plan"),String("Projection: #issue59.id + Int64(1), #COUNT(DISTINCT issue59.account)\n  Aggregate: groupBy=[[#issue59.id + Int64(1)]], aggr=[[COUNT(DISTINCT #issue59.account)]]\n    TableScan: issue59 projection=[id, account]"),
String("physical_plan"),String("ProjectionExec: expr=[issue59.id + Int64(1)@0 as issue59.id + Int64(1), COUNT(DISTINCT issue59.account)@1 as COUNT(DISTINCT issue59.account)]\n  AggregateExec: mode=FinalPartitioned, gby=[issue59.id + Int64(1)@0 as issue59.id + Int64(1)], aggr=[COUNT(DISTINCT issue59.account)]\n    CoalesceBatchesExec: target_batch_size=4096\n      RepartitionExec: partitioning=Hash([Column { name: \"issue59.id + Int64(1)\", index: 0 }], 8)\n        AggregateExec: mode=Partial, gby=[CAST(id@0 AS Int64) + 1 as issue59.id + Int64(1)], aggr=[COUNT(DISTINCT issue59.account)]\n          ScanTable: table=issue59, parallelism=8, order=None, \n"),


